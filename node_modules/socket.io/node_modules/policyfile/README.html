<h2 id="lol-wut-">LOL, WUT?</h2>
<p>It basically allows you to allow or disallow Flash Player sockets from accessing your site.</p>
<h2 id="installation">Installation</h2>
<pre><code class="lang-bash">npm install policyfile</code></pre>
<h2 id="usage">Usage</h2>
<p>The server is based on the regular and know <code>net</code> and <code>http</code> server patterns. So it you can just listen
for all the events that a <code>net</code> based server emits etc. But there is one extra event, the <code>connect_failed</code>
event. This event is triggered when we are unable to listen on the supplied port number.</p>
<h3 id="createserver">createServer</h3>
<p>Creates a new server instance and accepts 2 optional arguments:</p>
<ul>
<li><code>options</code> <strong>Object</strong> Options to configure the server instance<ul>
<li><code>log</code> <strong>Boolean</strong> Enable logging to STDOUT and STDERR (defaults to true)</li>
</ul>
</li>
<li><code>origins</code> <strong>Array</strong> An Array of origins that are allowed by the server (defaults to <em>:</em>)</li>
</ul>
<pre><code class="lang-js">var pf = require(&#39;policyfile&#39;);
pf.createServer();
pf.listen();</code></pre>
<h4 id="server-listen">server.listen</h4>
<p>Start listening on the server and it takes 3 optional arguments</p>
<ul>
<li><code>port</code> <strong>Number</strong> On which port number should we listen? (defaults to 843, which is the first port number the FlashPlayer checks)</li>
<li><code>server</code> <strong>Server</strong> A http server, if we are unable to accept requests or run the server we can also answer the policy requests inline over the supplied HTTP server.</li>
<li><code>callback</code> <strong>Function</strong> A callback function that is called when listening to the server was successful.</li>
</ul>
<pre><code class="lang-js">var pf = require(&#39;policyfile&#39;);
pf.createServer();
pf.listen(1337, function(){
  console.log(&#39;:3 yay&#39;)
});</code></pre>
<p>Changing port numbers can be handy if you do not want to run your server as root and have port 843 forward to a non root port number (aka a number above 1024).</p>
<pre><code class="lang-js">var pf = require(&#39;policyfile&#39;)
  , http = require(&#39;http&#39;);

server = http.createServer(function(q,r){r.writeHead(200);r.end(&#39;hello world&#39;)});
server.listen(80);

pf.createServer();
pf.listen(1337, server, function(){
  console.log(&#39;:3 yay&#39;)
});</code></pre>
<p>Support for serving inline requests over a existing HTTP connection as the FlashPlayer will first check port 843, but if it&#39;s unable to get a response there it will send a policy file request over port 80, which is usually your http server.</p>
<h4 id="server-add">server.add</h4>
<p>Adds more origins to the policy file you can add as many arguments as you like.</p>
<pre><code class="lang-js">var pf = require(&#39;policyfile&#39;);
pf.createServer([&#39;google.com:80&#39;]);
pf.listen();
pf.add(&#39;blog.3rd-Eden.com:80&#39;, &#39;blog.3rd-Eden.com:8080&#39;); // now has 3 origins</code></pre>
<h4 id="server-add">server.add</h4>
<p>Adds more origins to the policy file you can add as many arguments as you like.</p>
<pre><code class="lang-js">var pf = require(&#39;policyfile&#39;);
pf.createServer([&#39;blog.3rd-Eden.com:80&#39;, &#39;blog.3rd-Eden.com:8080&#39;]);
pf.listen();
pf.remove(&#39;blog.3rd-Eden.com:8080&#39;); // only contains the :80 version now</code></pre>
<h4 id="server-close">server.close</h4>
<p>Shuts down the server</p>
<pre><code class="lang-js">var pf = require(&#39;policyfile&#39;);
pf.createServer();
pf.listen();
pf.close(); // OH NVM.</code></pre>
<h2 id="api">API</h2>
<p><a href="http://3rd-eden.com/FlashPolicyFileServer/">http://3rd-eden.com/FlashPolicyFileServer/</a></p>
<h2 id="examples">Examples</h2>
<p>See <a href="https://github.com/3rd-Eden/FlashPolicyFileServer/tree/master/examples">https://github.com/3rd-Eden/FlashPolicyFileServer/tree/master/examples</a> for examples</p>
<h2 id="licence">Licence</h2>
<p>MIT see LICENSE file in the repository</p>
